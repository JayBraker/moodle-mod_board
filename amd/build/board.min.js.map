{"version":3,"sources":["../src/board.js"],"names":["define","$","Str","Ajax","Notification","_serviceCall","method","args","callback","failcallback","call","methodname","done","data","bind","fail","error","exception","board","options","strings","default_column_heading","post_button_text","cancel_button_text","remove_note_text","remove_column_text","note_changed_text","note_deleted_text","Ok","Cancel","warning","reloadTimer","lastHistoryId","isEditor","userId","noteTextCache","editingNote","serviceCall","stopUpdating","apply","arguments","updateBoard","getNote","ident","getNoteText","showNewNoteButtons","show","hideNewNoteButtons","hide","stopNoteEdit","html","note","find","startNoteEdit","pendingNote","remove","deleteNote","confirm","id","result","status","historyid","addNote","columnid","content","owner","ismynote","iseditable","addClass","notecontent","noteText","append","column_content","buttons","postbutton","cancelbutton","removeElement","on","e","type","keyCode","preventDefault","dblclick","sortNotes","editable","toggleFontSize","closeOnEnter","$el","innerHTML","lastOne","last","length","insertAfter","prepend","addColumn","name","notes","nameCache","column","column_header","column_sort","column_name","column_newcontent","noteicon","index","userid","addNewColumnButton","newBusy","columnicon","boardid","processBoardHistory","since","boardhistory","item","action","noteid","split","alert","instant","setTimeout","clearTimeout","toggle","sort_col","parent","direction","removeClass","sort","a","b","appendTo","init","columns","stringsInfo","string","push","key","component","when","get_strings","results"],"mappings":"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","sourcesContent":["define(['jquery', 'core/str', 'core/ajax', 'core/notification', 'mod_board/jquery.editable.amd'], function($, Str, Ajax, Notification) {\r\n    \r\n    var _serviceCall = function(method, args, callback, failcallback) {\r\n        Ajax.call([{\r\n            methodname: 'mod_board_' + method,\r\n            args: args,\r\n            done: function(data) {\r\n                callback(data);\r\n            }.bind(this),\r\n            fail: function(error) {\r\n                Notification.exception(error);\r\n                if (failcallback) {\r\n                    failcallback(error);\r\n                }\r\n            }\r\n        }]);\r\n    };\r\n        \r\n    return function(board, options) {\r\n        var strings = {\r\n            default_column_heading: '',\r\n            post_button_text: '',\r\n            cancel_button_text: '',\r\n            remove_note_text: '',\r\n            remove_column_text: '',\r\n            note_changed_text: '',\r\n            note_deleted_text: '',\r\n            Ok: '',\r\n            Cancel: '',\r\n            warning: ''\r\n            \r\n        };\r\n        \r\n        var reloadTimer = null;\r\n        var lastHistoryId = null;\r\n        var isEditor = options.isEditor || false;\r\n        var userId = options.userId || -1;\r\n        var noteTextCache = null;\r\n        var editingNote = 0;\r\n        \r\n        var serviceCall = function(method, args, callback, failcallback) {\r\n            if (method!=='board_history') {\r\n                stopUpdating();\r\n            }\r\n            _serviceCall(method, args, function() {\r\n                callback.apply(null, arguments);\r\n                if (method!=='board_history') {\r\n                    updateBoard(true);\r\n                }\r\n            }, failcallback);\r\n        }\r\n        \r\n        var getNote = function(ident) {\r\n            return $(\".board_note[data-ident='\"+ident+\"']\");\r\n        }\r\n        \r\n        var getNoteText = function(ident) {\r\n            return $(\".board_note[data-ident='\"+ident+\"'] .note_text\");\r\n        }\r\n        \r\n        var showNewNoteButtons = function() {\r\n            $('.board_column .board_column_newcontent .board_button.newnote').show();\r\n        }\r\n        \r\n        var hideNewNoteButtons = function() {\r\n            $('.board_column .board_column_newcontent .board_button.newnote').hide();\r\n        }\r\n        \r\n        var stopNoteEdit = function() {\r\n            if (noteTextCache) {\r\n                getNoteText(editingNote).html(noteTextCache);\r\n                noteTextCache = null;\r\n            }\r\n            \r\n            var note = getNote(editingNote);\r\n            if (note) {\r\n                note.find('.note_buttons').hide();\r\n                showNewNoteButtons();\r\n            }\r\n            \r\n            editingNote = 0;\r\n        }\r\n        \r\n        var startNoteEdit = function(ident) {\r\n            if (editingNote) {\r\n                if (editingNote==ident) {\r\n                    return;\r\n                }\r\n                stopNoteEdit();\r\n            }\r\n            \r\n            var pendingNote = getNote(0);\r\n            if (pendingNote) {\r\n                pendingNote.remove();\r\n            }\r\n            \r\n            var note = getNote(ident);\r\n            if (note) {\r\n                note.find('.note_buttons').show();\r\n                hideNewNoteButtons();\r\n                noteTextCache = note.find('.note_text').html();\r\n                editingNote = ident;\r\n            }\r\n        }\r\n        \r\n        var deleteNote = function(ident) {\r\n            if (confirm(strings.remove_note_text)) {\r\n                serviceCall('delete_note', {id: ident}, function(result) {\r\n                    if (result.status) {\r\n                        lastHistoryId = result.historyid;\r\n                        getNote(ident).remove();\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        \r\n        var addNote = function(columnid, ident, content, owner) {\r\n            var ismynote = owner.id==userId || !ident;\r\n            var iseditable = isEditor || ismynote;\r\n            \r\n            if (!ident) {\r\n                var pendingNote = getNote(0);\r\n                if (pendingNote) {\r\n                    pendingNote.remove();\r\n                }\r\n            }\r\n            \r\n            var note = $('<div class=\"board_note\" data-ident=\"'+ident+'\"></div>');\r\n            if (ismynote) {\r\n                note.addClass('mynote');\r\n            }\r\n            if (iseditable) {\r\n                note.addClass('editablenote');\r\n            }\r\n            \r\n            var notecontent = $('<div class=\"note_content\"></div>');\r\n            var noteText = $('<div class=\"note_text\" tabindex=\"0\">'+content+'</div>');\r\n            notecontent.append(noteText);\r\n            note.append(notecontent);\r\n            \r\n            var column_content = $('.board_column[data-ident='+columnid+'] .board_column_content');\r\n            \r\n            if (iseditable) {\r\n                var buttons = $('<div class=\"note_buttons\"></div>');\r\n                buttons.hide();\r\n                var postbutton = $('<div class=\"post_button\" role=\"button\" tabindex=\"0\">'+strings.post_button_text+'</div>');\r\n                var cancelbutton = $('<div class=\"cancel_button\" role=\"button\" tabindex=\"0\">'+strings.cancel_button_text+'</div>');\r\n                buttons.append(postbutton);\r\n                buttons.append(cancelbutton);\r\n                note.append(buttons);\r\n                \r\n                var removeElement = $('<div class=\"remove fa fa-remove\" role=\"button\" tabindex=\"0\"></div>');\r\n                removeElement.on('click keypress', function(e) {\r\n                    if (e.type=='keypress') {\r\n                        if (e.keyCode===13) {\r\n                            e.preventDefault();\r\n                        } else {\r\n                            return;\r\n                        }\r\n                    }\r\n                    \r\n                    deleteNote(ident);\r\n                });\r\n                if (!ident) {\r\n                    removeElement.hide();\r\n                }\r\n                notecontent.append(removeElement);\r\n                \r\n                cancelbutton.on('click keypress', function(e) {\r\n                    if (e.type=='keypress') {\r\n                        if (e.keyCode===13) {\r\n                            e.preventDefault();\r\n                        } else {\r\n                            return;\r\n                        }\r\n                    }\r\n                    if (!ident) {\r\n                        note.remove();\r\n                        showNewNoteButtons();\r\n                    } else {\r\n                        stopNoteEdit();\r\n                    }\r\n                });\r\n                \r\n                noteText.on('dblclick keypress', function(e) {\r\n                    if (e.type=='keypress') {\r\n                        if (e.keyCode===13) {\r\n                            e.preventDefault();\r\n                            noteText.dblclick();\r\n                            return;\r\n                        } else {\r\n                            return;\r\n                        }\r\n                    }\r\n                    \r\n                    if (ident) {\r\n                        startNoteEdit(ident);\r\n                    } else {\r\n                        hideNewNoteButtons();\r\n                        buttons.show();\r\n                    }\r\n                });\r\n                \r\n                postbutton.on('click keypress', function(e) {\r\n                    if (e.type=='keypress') {\r\n                        if (e.keyCode===13) {\r\n                            e.preventDefault();\r\n                        } else {\r\n                            return;\r\n                        }\r\n                    }\r\n                    \r\n                    if (!ident) { // new\r\n                        serviceCall('add_note', {columnid: columnid, content: noteText.html()}, function(result) {\r\n                            lastHistoryId = result.historyid;\r\n                            \r\n                            note.remove();\r\n                            showNewNoteButtons();\r\n                            addNote(columnid, result.id, noteText.html(), {id: userId});\r\n                            sortNotes(column_content);\r\n                        });\r\n                        \r\n                    } else { // update\r\n                        serviceCall('update_note', {id: ident, content: noteText.html()}, function(result) {\r\n                            if (result.status) {\r\n                                noteTextCache = null;\r\n                                stopNoteEdit();\r\n                                lastHistoryId = result.historyid;\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n                \r\n                noteText.editable({\r\n                    toggleFontSize : false,\r\n                    closeOnEnter: false,\r\n                    callback : function( data ) {\r\n                        if (!ident && !data.$el[0].innerHTML) { // hide new note if empty\r\n                            note.remove();\r\n                            showNewNoteButtons();\r\n                        }\r\n                    }\r\n                    \r\n                });\r\n            }\r\n            \r\n            if (ident) {\r\n                var lastOne = column_content.find(\".board_note\").last();\r\n                if (lastOne.length) {\r\n                    note.insertAfter(lastOne);\r\n                } else {\r\n                    column_content.prepend(note);\r\n                }\r\n            } else {\r\n                $('.board_column[data-ident='+columnid+'] .board_column_newcontent').append(note);\r\n                noteText.dblclick(); // trigger edit of note\r\n            }\r\n        };\r\n        \r\n        var addColumn = function(ident, name, notes, sort) {\r\n            var iseditable = isEditor;\r\n            var nameCache = null;\r\n            var column = $('<div class=\"board_column board_column_hasdata\" data-ident=\"'+ident+'\"></div>');\r\n            var column_header = $('<div class=\"board_column_header\"></div>');\r\n            var column_sort = $('<div class=\"column_sort fa\"></div>');\r\n            var column_name = $('<div class=\"column_name\" tabindex=\"0\">'+name+'</div>');\r\n            var column_content = $('<div class=\"board_column_content\"></div>');\r\n            var column_newcontent = $('<div class=\"board_column_newcontent\"></div>');\r\n            column_header.append(column_sort);\r\n            column_header.append(column_name);\r\n            \r\n            column_sort.on('click', function() {\r\n                sortNotes(column_content, true);\r\n            });\r\n            \r\n            if (iseditable) {\r\n                column.addClass('editablecolumn');\r\n\r\n                var removeElement = $('<div class=\"remove fa fa-remove\" role=\"button\" tabindex=\"0\"></div>');\r\n                removeElement.on('click keypress', function(e) {\r\n                    if (e.type=='keypress') {\r\n                        if (e.keyCode===13) {\r\n                            e.preventDefault();\r\n                        } else {\r\n                            return;\r\n                        }\r\n                    }\r\n                    \r\n                    if (confirm(strings.remove_column_text)) {\r\n                        serviceCall('delete_column', {id: ident}, function(result) {\r\n                            if (result.status) {\r\n                                column.remove();\r\n                                lastHistoryId = result.historyid;\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n                \r\n                column_header.append(removeElement);\r\n            }\r\n            \r\n            column.append(column_header);\r\n            column.append(column_content);\r\n            column.append(column_newcontent);\r\n            \r\n            if (iseditable) {\r\n                column_name.on('dblclick keypress', function(e) {\r\n                    if (e.type=='keypress') {\r\n                        if (e.keyCode===13) {\r\n                            e.preventDefault();\r\n                            column_name.dblclick();\r\n                        } else {\r\n                            return;\r\n                        }\r\n                    }\r\n                    \r\n                    nameCache = column_name.html();\r\n                });\r\n                \r\n                column_name.editable({\r\n                    toggleFontSize : false,\r\n                    closeOnEnter: true,\r\n                    callback : function( data ) {\r\n                        if ( data.content ) {\r\n                            serviceCall('update_column', {id: ident, name: column_name.html()}, function(result) {\r\n                                if (!result.status) {\r\n                                    column_name.html(nameCache);\r\n                                    nameCache = null;\r\n                                } else {\r\n                                    lastHistoryId = result.historyid;\r\n                                }\r\n                            }, function() {\r\n                                column_name.html(nameCache);\r\n                                nameCache = null;\r\n                            });\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            column_newcontent.append('<div class=\"board_button newnote\" role=\"button\" tabindex=\"0\"><div class=\"button_content\"><span class=\"fa '+options.noteicon+'\"></span></div></div>');\r\n            column_newcontent.on('click keypress', '.newnote', function(e) {\r\n                if (e.type=='keypress') {\r\n                    if (e.keyCode===13) {\r\n                        e.preventDefault();\r\n                    } else {\r\n                        return;\r\n                    }\r\n                }\r\n                \r\n                addNote(ident, 0, '', {id: userId});\r\n            });\r\n\r\n            var lastOne = $(\".mod_board .board_column_hasdata\").last();\r\n            if (lastOne.length) {\r\n                column.insertAfter(lastOne);\r\n            } else {\r\n                $(\".mod_board\").append(column);\r\n            }\r\n                        \r\n            if (notes) {\r\n                for (index in notes) {\r\n                    addNote(ident, notes[index].id, notes[index].content, {id: notes[index].userid});\r\n                }\r\n            }\r\n            sortNotes(column_content, true);\r\n        };\r\n        \r\n        var addNewColumnButton = function() {\r\n            var column = $('<div class=\"board_column board_column_empty\"></div>');\r\n            var newBusy = false;\r\n            column.append('<div class=\"board_button newcolumn\" role=\"button\" tabindex=\"0\"><div class=\"button_content\"><span class=\"fa '+options.columnicon+'\"></span></div></div>');\r\n            column.on('click keypress', '.newcolumn', function(e) {\r\n                if (newBusy) {\r\n                    return;\r\n                }\r\n                newBusy = true;\r\n                if (e.type=='keypress') {\r\n                    if (e.keyCode===13) {\r\n                        e.preventDefault();\r\n                    } else {\r\n                        return;\r\n                    }\r\n                }\r\n                \r\n                serviceCall('add_column', {boardid: board.id, name: strings.default_column_heading}, function(result) {\r\n                    addColumn(result.id, strings.default_column_heading);\r\n                    lastHistoryId = result.historyid;\r\n                    newBusy = false;\r\n                }, function(error) {\r\n                    newBusy = false;\r\n                });\r\n            });\r\n            \r\n            $(\".mod_board\").append(column);\r\n        };\r\n        \r\n        var processBoardHistory = function() {\r\n            serviceCall('board_history', {id: board.id, since: lastHistoryId}, function(boardhistory) {\r\n                for (index in boardhistory) {\r\n                    var item = boardhistory[index];\r\n                    if (item.boardid!=board.id) {\r\n                        continue; // hmm\r\n                    }\r\n                    if (item.action=='add_note') {\r\n                        addNote(item.columnid, item.noteid, item.content, {id: item.userid});\r\n                    } else if (item.action=='update_note') {\r\n                        var note = getNote(item.noteid);\r\n                        if (note) {\r\n                            if (editingNote==item.noteid) {\r\n                                noteTextCache = item.content;\r\n                                \r\n                                Notification.confirm(\r\n                                    strings.note_changed_text.split(\"\\n\")[0], // Confirm.\r\n                                    strings.note_changed_text.split(\"\\n\")[1], // Are you sure?\r\n                                    strings.Ok,\r\n                                    strings.Cancel,\r\n                                    function() {\r\n                                        if (editingNote==item.noteid) {\r\n                                            note.find('.note_text').html(item.content);\r\n                                        }\r\n                                        stopNoteEdit();\r\n                                    }\r\n                                );\r\n                            } else {\r\n                                note.find('.note_text').html(item.content);\r\n                            }\r\n                        }\r\n                    } else if (item.action=='delete_note') {\r\n                        if (editingNote==item.noteid) {\r\n                            Notification.alert(strings.warning, strings.note_deleted_text);\r\n                            stopNoteEdit();\r\n                        }\r\n                        $(\".board_note[data-ident='\"+item.noteid+\"']\").remove();\r\n                        \r\n                    } else if (item.action=='add_column') {\r\n                        addColumn(item.columnid, item.content);\r\n                    } else if (item.action=='update_column') {\r\n                        $(\".board_column[data-ident='\"+item.columnid+\"'] .column_name\").html(item.content);\r\n                    } else if (item.action=='delete_column') {\r\n                        var column = $(\".board_column[data-ident='\"+item.columnid+\"']\");\r\n                        if (editingNote && column.find('.board_note[data-ident=\"'+editingNote+'\"]').length) {\r\n                            stopNoteEdit();\r\n                        }\r\n                        column.remove();\r\n                    }\r\n                    lastHistoryId = item.id;\r\n                }\r\n                \r\n                updateBoard();\r\n            });\r\n        };\r\n        \r\n        var updateBoard = function(instant) {\r\n            if (instant) {\r\n                processBoardHistory();\r\n            } else {\r\n                if (reloadTimer) {\r\n                    stopUpdating();\r\n                }\r\n                reloadTimer = setTimeout(processBoardHistory, 2000);\r\n            }\r\n        }\r\n        \r\n        var stopUpdating = function() {\r\n            clearTimeout(reloadTimer);\r\n            reloadTimer = null;\r\n        }\r\n        \r\n        var sortNotes = function(content, toggle) {\r\n            var sort_col = $(content).parent().find('.column_sort');\r\n            var direction = $(content).data('sort');\r\n            if (toggle) {\r\n                direction = direction=='asc'?'desc':'asc';\r\n            }\r\n            \r\n            if (direction=='asc') {\r\n                sort_col.removeClass('fa-angle-down');\r\n                sort_col.addClass('fa-angle-up');\r\n            } else {\r\n                sort_col.removeClass('fa-angle-up');\r\n                sort_col.addClass('fa-angle-down');\r\n            }\r\n            $(content).data('sort', direction);\r\n            \r\n            $('> .board_note', $(content)).sort(direction=='asc'?asc:desc).appendTo($(content));\r\n            function desc(a, b) { return $(b).data(\"ident\") < $(a).data(\"ident\") ? -1 : 1; }\r\n            function asc(a, b) { return $(b).data(\"ident\") < $(a).data(\"ident\") ? 1 : -1; }\r\n        }\r\n        \r\n        var init = function() {\r\n            serviceCall('get_board', {id: board.id}, function(columns) {\r\n                // init\r\n                if (columns) {\r\n                    for (index in columns) {\r\n                        addColumn(columns[index].id, columns[index].name, columns[index].notes || {});\r\n                    }\r\n                }\r\n                if (isEditor) {\r\n                    addNewColumnButton();\r\n                }\r\n                \r\n                lastHistoryId = board.historyid;\r\n            });\r\n        };\r\n   \r\n        // get strings\r\n        var stringsInfo = [];\r\n        for (string in strings) {\r\n            stringsInfo.push({key: string, component: 'mod_board'});\r\n        }\r\n                \r\n        $.when(Str.get_strings(stringsInfo)).done(function(results) {\r\n            var index = 0;\r\n            for (string in strings) {\r\n                strings[string] = results[index++];\r\n            }\r\n            \r\n            init();\r\n        });\r\n    };\r\n});"],"file":"board.min.js"}